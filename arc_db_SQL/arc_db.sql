
USE arc;

SET FOREIGN_KEY_CHECKS = 0;
DROP TABLE IF EXISTS DEPARTMENT;
DROP TABLE IF EXISTS  STUDENT;
DROP TABLE IF EXISTS  EQUIPMENT;
DROP TABLE IF EXISTS  EQUIPMENT_BORROWED;
DROP TABLE IF EXISTS  STUDENT_ADDRESS;
DROP TABLE IF EXISTS  ACTIVITY;
DROP TABLE IF EXISTS  ACTIVITY_PARTICIPATE;
DROP TABLE IF EXISTS  ROOM;
DROP TABLE IF EXISTS  ROOM_RESERVE;
SET FOREIGN_KEY_CHECKS = 1;


CREATE TABLE DEPARTMENT
(
d_name VARCHAR(30) NOT NULL,
d_phone VARCHAR(15),
PRIMARY KEY (d_name),
UNIQUE (d_name),
CHECK (d_name = "Intramurals" OR d_name = "Fitness" OR  d_name = "Game" OR d_name = "Camp" OR d_name = "Sport")
);


CREATE TABLE STUDENT
(
s_id CHAR(7) NOT NULL,
s_name VARCHAR(30) NOT NULL,
s_phone_num VARCHAR(15),
unique(s_id),
PRIMARY KEY (s_id),
CHECK (char_length(s_id) = 7)
);

Create Table EQUIPMENT
(
e_dname VARCHAR(25) NOT NULL,
e_serialNumber CHAR(4) NOT NULL,
e_name VARCHAR(25) NOT NULL,
e_type VARCHAR(10) NOT NULL,
e_yearBought INT,
Primary key (e_dname, e_serialNumber),
FOREIGN KEY (e_dname) REFERENCES DEPARTMENT(d_name) ON DELETE CASCADE ON UPDATE CASCADE,
unique(e_serialNumber),
CHECK (e_serialNumber >= 1 and e_serialNumber <= 9999),
CHECK (e_type = "Gaming" OR e_type = "Sporting" OR e_type = "Camping"),
CHECK  (e_stock  >= 0),
CHECK (e_yearBought >= 0 and e_yearBought <= YEAR(CURDATE()))
);

CREATE TABLE EQUIPMENT_BORROWED
(
eb_sid CHAR(7) NOT NULL,
eb_serialNumber CHAR(4) NOT NULL,
eb_checkedOut DATE NOT NULL,
eb_dueDate DATE NOT NULL,
eb_returned BOOLEAN NOT NULL DEFAULT 0,
PRIMARY KEY(eb_sid, eb_serialNumber),
FOREIGN KEY (eb_sid)  REFERENCES STUDENT(s_id) ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY (eb_serialNumber) REFERENCES EQUIPMENT(e_serialNumber) ON DELETE CASCADE ON UPDATE CASCADE,
CHECK (eb_serialNumber <= 9999 AND eb_serialNumber >= 0001),
CHECK(eb_checkedOut <= CURDATE()),
CHECK(eb_dueDate >= eb_checkedOut)
);



CREATE TABLE STUDENT_ADDRESS
(
sa_sid CHAR(7) NOT NULL,
sa_houseNumber INT,
sa_streetName VARCHAR(20),
sa_city VARCHAR(10),
sa_state VARCHAR(10),
sa_zip CHAR(5),
PRIMARY KEY(sa_sid),
FOREIGN KEY (sa_sid) REFERENCES STUDENT(s_id) ON DELETE CASCADE ON UPDATE CASCADE,
unique(sa_sid),
CHECK (char_length(sa_sid) = 7),
CHECK(sa_zip > 00000)
);

CREATE TABLE ACTIVITY
(
a_dname  VARCHAR(15) NOT NULL,
a_name 	 VARCHAR(20) NOT NULL,
a_id CHAR(4) NOT NULL,
a_type VARCHAR(20) NOT NULL,
a_date DATE NOT NULL,
PRIMARY KEY(a_dname, a_id),
FOREIGN KEY(a_dname) REFERENCES DEPARTMENT(d_name) ON DELETE CASCADE ON UPDATE CASCADE,
CHECK (a_id >= 0001 AND a_id <= 9999)
);

CREATE TABLE ROOM
(
r_dname VARCHAR(15) NOT NULL,
r_number VARCHAR(3) NOT NULL,
Primary Key(r_dname, r_number),
Foreign Key (r_dname) REFERENCES DEPARTMENT(d_name) ON DELETE CASCADE ON UPDATE CASCADE,
CHECK (char_length(r_number) = 10)
);


CREATE TABLE ACTIVITY_PARTICIPATE
(
ap_sid CHAR(7) NOT NULL REFERENCES STUDENT(s_id) ON DELETE CASCADE ON UPDATE CASCADE,
ap_aid CHAR(4) NOT NULL REFERENCES ACTIVITY(a_id) ON DELETE CASCADE ON UPDATE CASCADE,
PRIMARY KEY(ap_sid, ap_aid)
);

CREATE TABLE ROOM_RESERVE
(
rr_sid CHAR(7) NOT NULL REFERENCES STUDENT(s_id) ON DELETE CASCADE ON UPDATE CASCADE,
rr_dname VARCHAR(30) NOT NULL REFERENCES DEPARTMENT(d_name) ON DELETE CASCADE ON UPDATE CASCADE,
rr_rnumber VARCHAR(10) NOT NULL REFERENCES ROOM(r_number) ON DELETE CASCADE ON UPDATE CASCADE,
rr_checkIn DATETIME NOT NULL,
rr_checkOut DATETIME NOT NULL,
PRIMARY KEY(rr_sid, rr_dname, rr_rnumber)
);

-- DEPARTMENT INSERTS
INSERT INTO DEPARTMENT VALUES ('Fitness', '425-329-1111');
INSERT INTO DEPARTMENT VALUES ('Game', '425-329-1112');
INSERT INTO DEPARTMENT VALUES ('Camp', '425-329-1113');
INSERT INTO DEPARTMENT VALUES ('Sport', '425-329-1114');
INSERT INTO DEPARTMENT VALUES ('Intramurals', '425-329-1115');

-- EQUIPMENT INSERTS
INSERT INTO EQUIPMENT VALUES ('Fitness', '9999', 'Dumbbell 5LB', 'Sporting', 2016);
INSERT INTO EQUIPMENT VALUES ('Fitness','1121', 'Jump Rope', 'Sporting', 2015);
INSERT INTO EQUIPMENT VALUES ('Game', '5678', 'Monopoly', 'Gaming', 2017);
INSERT INTO EQUIPMENT VALUES ('Game', '2345', 'Mario Kart for Wii', 'Gaming', 2017);
INSERT INTO EQUIPMENT VALUES ('Game', '2346', 'Wii', 'Gaming', 2017);
INSERT INTO EQUIPMENT VALUES ('Camp', '2478', '4 Person Tent', 'Camping', 2014);
INSERT INTO EQUIPMENT VALUES ('Camp', '2477', 'Hiking poles', 'Camping', 2014);
INSERT INTO EQUIPMENT VALUES ('Intramurals', '8567', 'Soccer Ball', 'Sporting', 2016);
INSERT INTO EQUIPMENT VALUES ('Intramurals', '8547', 'Soccer Ball', 'Sporting', 2016);
INSERT INTO EQUIPMENT VALUES ('Intramurals', '8569', 'Basketball', 'Sporting', 2016);
INSERT INTO EQUIPMENT VALUES ('Intramurals', '8568', 'Volleyball', 'Sporting', 2016);
INSERT INTO EQUIPMENT VALUES ('Sport', '7890', 'Keiser Power Racks', 'Sporting', 2018);
INSERT INTO EQUIPMENT VALUES ('Sport', '7891', 'Precor Ellipticals', 'Sporting', 2018);

-- STUDENT INSERTS
INSERT INTO STUDENT VALUES ('1234567', 'WAI KWAN SHUM', '425-320-1234');
INSERT INTO STUDENT VALUES ('1111111', 'TERENCE HO', '425-212-1111');
INSERT INTO STUDENT VALUES ('2222222', 'BARDIA BORHANI', '206-123-4567');
INSERT INTO STUDENT VALUES ('3333333', 'JIN KIM', '425-325-3333');
INSERT INTO STUDENT VALUES ('4444444', 'JOHN MCDONALD', '206-111-4567');
INSERT INTO STUDENT VALUES ('7654321', 'MARY JANE', '206-222-4567');

-- STUDENT ADDRESS INSERTS
INSERT INTO STUDENT_ADDRESS VALUES ('1234567', 1234, 'WAI STREET', 'LAKE CITY', 'WA', '98125');
INSERT INTO STUDENT_ADDRESS VALUES ('1111111', 1111, 'TERENCE DRIVE', 'BOTHELL', 'WA', '98011');
INSERT INTO STUDENT_ADDRESS VALUES ('2222222', 2323, 'BARDIA BOULEVARD', 'REDMOND', 'WA', '98052');
INSERT INTO STUDENT_ADDRESS VALUES ('3333333', 1033, 'JIN AVENUE', 'EVERETT', 'WA', '98204');
INSERT INTO STUDENT_ADDRESS VALUES ('4444444', 4343, 'MCNUGGET STREET', 'SEATTLE', 'WA', '98134');
INSERT INTO STUDENT_ADDRESS VALUES ('7654321', 9876, 'QUEEN ANNE STREET', 'QUEEN ANNE', 'WA', '98256');


-- ACTIVITY INSERTS
INSERT INTO ACTIVITY VALUES ('Fitness', 'Spin Class', '1234', 'Workout', '2018-03-20');
INSERT INTO ACTIVITY VALUES ('Fitness', 'Yoga', '2222', 'Workout', '2018-03-25');
INSERT INTO ACTIVITY VALUES ('Game', 'Mario Kart party', '3456', 'Video Game', '2018-04-01');
INSERT INTO ACTIVITY VALUES ('Game', 'Monopoly party', '3457', 'Boardgame', '2018-04-05');
INSERT INTO ACTIVITY VALUES ('Camp', 'Camp Long', '2345', 'Camping', '2018-04-22');
INSERT INTO ACTIVITY VALUES ('Camp', 'Mountain Rainer', '2346', 'Camping', '2018-04-25');
INSERT INTO ACTIVITY VALUES ('Sport', 'DodgeBall', '1345', 'Tournament', '2018-03-22');
INSERT INTO ACTIVITY VALUES ('Sport', '5v5 Basketball', '1346', 'Sports Leagues', '2018-03-15');

-- ACTIVITY PARTICIPATE INSERTS
INSERT INTO ACTIVITY_PARTICIPATE VALUES ('1234567', '1234');
INSERT INTO ACTIVITY_PARTICIPATE VALUES ('1111111', '2222');
INSERT INTO ACTIVITY_PARTICIPATE VALUES ('2222222', '3456');
INSERT INTO ACTIVITY_PARTICIPATE VALUES ('3333333', '2345');
INSERT INTO ACTIVITY_PARTICIPATE VALUES ('1111111', '2345');
INSERT INTO ACTIVITY_PARTICIPATE VALUES ('4444444', '1345');
INSERT INTO ACTIVITY_PARTICIPATE VALUES ('2222222', '1345');
INSERT INTO ACTIVITY_PARTICIPATE VALUES ('7654321', '1345');
INSERT INTO ACTIVITY_PARTICIPATE VALUES ('4444444', '1346');
INSERT INTO ACTIVITY_PARTICIPATE VALUES ('7654321', '1346');
INSERT INTO ACTIVITY_PARTICIPATE VALUES ('1111111', '1346');
INSERT INTO ACTIVITY_PARTICIPATE VALUES ('1111111', '3457');
INSERT INTO ACTIVITY_PARTICIPATE VALUES ('3333333', '3457');
INSERT INTO ACTIVITY_PARTICIPATE VALUES ('7654321', '3457');



-- EQUIPMENT BORROWED INSERTS
INSERT INTO EQUIPMENT_BORROWED VALUES ('1234567', '5678', '2018-02-28', '2018-03-08', 1);
INSERT INTO EQUIPMENT_BORROWED VALUES ('1111111', '2478', '2018-02-26', '2018-03-05', 1);
INSERT INTO EQUIPMENT_BORROWED VALUES ('2222222', '9999', '2018-02-23', '2018-03-09', 0);
INSERT INTO EQUIPMENT_BORROWED VALUES ('3333333', '2345', '2018-02-28', '2018-03-05', 0);
INSERT INTO EQUIPMENT_BORROWED VALUES ('4444444', '1121', '2018-02-14', '2018-02-22', 1);
INSERT INTO EQUIPMENT_BORROWED VALUES ('1234567', '8567', '2018-02-14', '2018-02-22', 0);
INSERT INTO EQUIPMENT_BORROWED VALUES ('7654321', '2477', '2018-03-11', '2018-03-14', 0);
INSERT INTO EQUIPMENT_BORROWED VALUES ('7654321', '7890', '2018-03-02', '2018-03-14', 1);



-- ROOM INSERTS
INSERT INTO ROOM VALUES ('Fitness', '001');
INSERT INTO ROOM VALUES ('Fitness', '002');
INSERT INTO ROOM VALUES ('Game', '001');
INSERT INTO ROOM VALUES ('Game', '002');
INSERT INTO ROOM VALUES ('Sport', '001');
INSERT INTO ROOM VALUES ('Sport', '002');

-- ROOM RESERVE INSERTS
INSERT INTO ROOM_RESERVE VALUES ('1234567', 'Fitness','001', '2018-01-20 15:00:00', '2018-01-20 19:00:00');
INSERT INTO ROOM_RESERVE VALUES ('1111111', 'Fitness','002', '2018-01-22 12:00:00', '2018-01-22 14:00:00');
INSERT INTO ROOM_RESERVE VALUES ('2222222', 'Sport','001', '2018-02-15 13:30:00', '2018-02-15 14:30:00');
INSERT INTO ROOM_RESERVE VALUES ('3333333', 'Game','001', '2018-03-03 15:30:00', '2018-03-03 17:00:00');
INSERT INTO ROOM_RESERVE VALUES ('4444444', 'Game','002', '2018-02-15 14:30:00', '2018-02-15 16:00:00');
INSERT INTO ROOM_RESERVE VALUES ('7654321', 'Game','002', '2018-02-15 17:00:00', '2018-02-15 18:00:00');


